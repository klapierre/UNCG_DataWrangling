---
title: "Arthropod Hebivory in the Longleaf pine savanna"
author: "Will Mann"
date: "2023-05-01"
output: pdf_document
---
###Arthropod Herbivory under Nutrient Deposition and Drought

# ***Herbivory, a key ecosystem process across nearly all ecosystems***, impacts nutrient cycling, ensures energy transfer up food webs, and alters community dynamics. Herbivory is a particularly important driver of grassland and savanna dynamics with these systems supporting nearly all of the world’s mega-herbivore biomass.

**Insect herbivores**, when outbreaks occur, can have devastating effects on plant communities causing the death of certain individuals; however, lower continuous levels are more common and present throughout most ecosystems. Plant-insect herbivore interactions are nearly ubiquitous across the plant kingdom. Understanding *arthropod herbivory* and the role it plays in structuring ecosystems is critical, especially as the current *‘insect apocalypse’*, a worldwide decline in insect abundance, unfolds.

**Herbivore damage** is likely driven by three main components of an ecosystem: 1) *plant community composition*, 2) *plant nutrient content*, and 3) *insect community composition and abundance*. In this experiment, I will showcase various herbivore damage metrics taken from the Longleaf Pine Savanna, a perfect vector for arthropod-specific studies.

```{r, setup, include=FALSE}
setwd("D:/School Stuff/Graduate Stuff/Koerner Lab/R Studio files/Grad Research")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set("D:/School Stuff/Graduate Stuff/Koerner Lab/R Studio files/Grad Research" = '/tmp')

library(tidyverse)

Herb20<-read.csv("Entered Sandhills Leaf Damage Data_2020.csv", na.strings = "")

Herb20Stretch<- Herb20 %>%
  select(-Notes)%>%
  drop_na(Plot) %>%
  group_by(Block, Plot, Treatment, Replicate, Species) %>%
  gather(HerbType, HerbPerc,6:11)%>%
  ungroup() %>%
  drop_na(HerbPerc) %>%
  select(Block, Plot, Treatment, Replicate, Species, HerbType, HerbPerc) %>%
  mutate(Year="20") %>%
  filter(Species!="Chrysopsis_mariana")%>%
  filter(Species!="Lespedeza_hirta") %>%
  filter(HerbType==c("Chew","Mine.Suck"))


Herb21<-read.csv("Entered Sandhills Leaf Damage Data_2021.csv", na.strings = "")

Herb21Stretch<- Herb21 %>%
  select(-Notes)%>%
  drop_na(Plot) %>%
  group_by(Block, Plot, Treatment, Rep, Species) %>%
  gather(HerbType, HerbPerc,6:11)%>%
  ungroup() %>%
  drop_na(HerbPerc) %>%
  select(-X) %>%
  mutate(Year="21") %>%
  filter(HerbType==c("Chew","Mine.Suck"))


TP1Herb22<-read.csv("Mann_Leaf_Damage_Sandhill_Gamelands_2022.csv", na.strings = "")

TP1Herb22Stretch<- TP1Herb22 %>%
  select(-Notes, -Date, -Damage.Assesser.s., -Scribe)%>%
  drop_na(Plot) %>%
  group_by(Block, Plot, Treatment, Replicate, Species) %>%
  gather(HerbType, HerbPerc,6:11)%>%
  ungroup() %>%
  drop_na(HerbPerc) %>%
  mutate(Year="TP1") %>%
  filter(HerbType==c("Chew","Mine.Suck"))


HComp2020_21<- full_join(Herb20Stretch, Herb21Stretch)
```

```{r herbivory, include=FALSE, message=FALSE, warning=FALSE}
####Hcompall####

HCompall<-full_join(HComp2020_21, TP1Herb22Stretch) %>%
  drop_na(HerbPerc) %>%
  filter(HerbType==c("Chew","Mine.Suck")) %>%
  group_by(Block, Plot, Treatment, Species, HerbType, Year) %>%
  summarise(avgherb=mean(HerbPerc)) %>%
  ungroup() %>%
  filter(Species!="Chrysopsis_mariana")%>%
  filter(Species!="Lespedeza_hirta") %>%
  filter(Species!="Liatris_cokeri")%>%
  filter(Species!="Dichanthelium_commutatum") %>%
  mutate(Treatment_Year=paste(Treatment, Year, sep="_"))



HerbDam<-HCompall %>%
  summarise(Plot, Species, Treatment_Year, HerbType, avgherb, Year, Treatment) %>%
  group_by(Plot, Species, Treatment_Year) %>%
  mutate(Damage= sum(avgherb))%>%
  ungroup() %>%
  mutate(totaldam=Damage) %>%
  select(Plot, Species, Treatment_Year, avgherb, totaldam, Year, Treatment, HerbType)
```

```{r treatments,include=FALSE, message=FALSE, warning=FALSE}
#Bind N and P together
HerbTypeTreat20<- ggplot(Herb20Stretch, aes(x=Treatment, y=HerbPerc, fill=HerbType))+
  geom_bar(stat="identity",position="dodge")
HerbTypeTreat20


HerbTypeTreat21<- ggplot(Herb21Stretch, aes(x=Treatment, y=HerbPerc, fill=HerbType))+
  geom_bar(stat="identity",position="dodge")
HerbTypeTreat21


HerbTypeTreatTP1<- ggplot(TP1Herb22Stretch, aes(x=Treatment, y=HerbPerc, fill=HerbType))+
  geom_bar(stat="identity",position="dodge")
HerbTypeTreatTP1


Herball<- ggplot(HCompall, aes(x=Treatment_Year, y=avgherb, fill=HerbType))+
  geom_bar(stat="identity",position="dodge")
Herball
```

```{r damage, treatment and sample, warning=FALSE}
#Bind N+P to treatment
#Total Arthropod Herbivory damage across all years and species
HerbDamage <- ggplot(data = HerbDam, aes(x = Treatment, y = totaldam, fill=Year)) + ggtitle("Total Arthropod Herbivore Damage across all years and species") +geom_bar(stat = "identity") + facet_grid(~ Year, scales = "free")
HerbDamage


#Total Arthropod Herbivory damage across all years on Aristida stricta
ASDamage<- ggplot(data=subset(HerbDam, Species == "Aristida_stricta"), aes(x = Treatment, y = totaldam, fill=Year)) + ggtitle("Total Herbivore Damage on Aristida stricta across all years") + geom_bar(stat = "identity") + facet_grid(~ Year, scales = "free")
ASDamage


#Total across years on Pityopsis aspera
PAHerbDam<- HerbDam %>%
  filter(Species=="Pityopsis_aspera")


PADamage<- ggplot(data = PAHerbDam, aes(x = Treatment, y = totaldam, fill=Year)) + ggtitle("Total Herbivore Damage on Pityopsis aspera across all years") + geom_bar(stat = "identity") + facet_grid(~ Year, scales = "free")
PADamage

#Total across years on Pteridium aquilinum
PtAHerbDam<-ggplot(data=subset(HerbDam, Species == "Pteridium_aquilinum"), aes(x = Treatment, y = totaldam, fill = Year)) +ggtitle("Total Herbivore Damage on Pteridium aquilinum across all years") + geom_bar(stat = "identity")+ facet_wrap( ~ Year, scales = "free")
PtAHerbDam

#Total across years on Vaccinium tenellum
VtHerbDam<-ggplot(data=subset(HerbDam, Species == "Vaccinium_tenellum"), aes(x = Treatment, y = totaldam, fill = Year)) +ggtitle("Total Herbivore Damage on Vaccinium tenellum across all years") + geom_bar(stat = "identity")+ facet_wrap( ~ Year, scales = "free")
VtHerbDam





####HerbPlot figures####
Herbplot<- ggplot(data = HCompall, aes(x = Treatment, y = avgherb, fill = HerbType)) + ggtitle("Herbivore Damage by Type across all species") +geom_bar(stat = "identity") + facet_grid(HerbType ~ Year, scales = "free")
Herbplot


HCompall20<- HCompall %>%
  filter(Year=="20")

HCompall21<- HCompall %>%
  filter(Year=="21")

HCompallTP1<- HCompall %>%
  filter(Year=="TP1")

ASplot<- ggplot(data=subset(HCompall, Species == "Aristida_stricta"), aes(x = Treatment, y = avgherb, fill = HerbType)) +ggtitle("Aristida stricta Herbivore Damage by Type") + geom_bar(stat = "identity")+ facet_wrap( ~ Year, scales = "free")
ASplot


ASplot20<- ggplot(data=subset(HCompall20, Species == "Aristida_stricta"), aes(x = Treatment, y = avgherb, fill = HerbType)) +ggtitle("Aristida stricta 2020 Herbivore Damage by Type") + geom_bar(stat = "identity")+ facet_wrap( ~ Year, scales = "free")
ASplot20

ASplot21<- ggplot(data=subset(HCompall21, Species == "Aristida_stricta"), aes(x = Treatment, y = avgherb, fill = HerbType)) +ggtitle("Aristida stricta 2021 Herbivore Damage by Type") + geom_bar(stat = "identity")+ facet_wrap( ~ Year, scales = "free")
ASplot21

ASplotTP1<- ggplot(data=subset(HCompallTP1, Species == "Aristida_stricta"), aes(x = Treatment, y = avgherb, fill = HerbType)) +ggtitle("Aristida stricta TP1 Herbivore Damage by Type") + geom_bar(stat = "identity")+ facet_wrap( ~ Year, scales = "free")
ASplotTP1


PAplot<- ggplot(data=subset(HCompall, Species == "Pityopsis_aspera"), aes(x = Treatment, y = avgherb, fill = HerbType)) +ggtitle("Pityopsis aspera Herbivore Damage across years by Type") + geom_bar(stat = "identity")+ facet_wrap( ~ Year, scales = "free")
PAplot


PtAplot<- ggplot(data=subset(HCompall, Species == "Pteridium_aquilinum"), aes(x = Treatment, y = avgherb, fill = HerbType))+ggtitle("Pteridium aquilinum Herbivore Damage across years by Type") + geom_bar(stat = "identity") + facet_wrap( ~ Year, scales = "free")
PtAplot


VTplot<- ggplot(data=subset(HCompall, Species == "Vaccinium_tenellum"), aes(x = Treatment, y = avgherb, fill = HerbType))+ggtitle("Vaccinium tenellum Herbivore Damage across years by Type") + geom_bar(stat = "identity") + facet_wrap( ~ Year, scales = "free")
VTplot
 
```



### Conclusions

Overall, it seems as if total damage is *increasing* in **all treatments** from year-to-year. Different focal species are herbivorized differently due to feeding guild difference and preference. In the 'Total Herbivore Damage on *Pityopsis aspera* across all years' figure, NPK treatments in timepoint 1 (TP1) exibit a great deal of herbivore damage, even compared to treatments within its own timescale. This informs us that the NPK plot has been preferred by present arthropods as a vital source of nutrients. In TP1, there is a *slight* decrease in herbivore damage. This may be due to the growing of plants through time. Plant do not 'heal' as other organisms do. As the leaf grows, so too does the hole that an arthropod may have left early in that plant's lifespan. The peak season results from 2020 and 2021 may be due to the *expansion* of those holes through time. I expect that, **once TP2 is included in these figures, there will be a significant increase in herbivore damage from the intra-seasonal sampling**.


There is evidence that differences in herbivore may be due to the arthropod community, specifically the family *Formicidae*, or Ants. There has been a large influx of ants into the community in 2021, and that trend seems to be continuing into timepoint 1 of 2022. Should the ants be responsible, it does indicate a few things. One, *ants may be used as an indicator species of nutrient-rich plants* within their zone-of-influence. Two, if ants are claiming the site as their own, it may be difficult to quantify the impact of other arthropods within the system. For now, we must wait and see what the LLP Savanna has to offer.

