---
title: "Comparing soil nutrients between an annual burned and patch burn grazing system"
author: "William Eichhorn"
date: "2023-03-13"
output: pdf_document
---
```{r, setup, include=FALSE}
knitr::opts_knit$set(root.dir = '~/UNCG_DataWrangling')
```

# BACKGROUND

### Annual burning and grazing

Homogeneity of the environment due to the production and management of cattle can be detrimental to the conservation of wildlife and plant populations in the surrounding area of agricultural systems. 
Annual burning and grazing (AGB) is a management system frequently employed to boost productivity in cattle, but this comes with severe deficits to the environment via the removal of necessary detritus and flora biodiversity. 

### Patch burn grazing
An alternative management strategy known at Patch burn grazing (PBG) which strikes a balance between a robust, healthy, and diverse ecosystem while allowing cattle farmers to maintain their herds' diets and well-being. PBG creates a flowing, heterogeneous landscape by shifting herds from unburned patches to recently burned areas to forage. These areas change and shift throughout the year to produce a fluid mosaic of ecosystems.
PBG has many benefits for biodiversity, ecosystem function and function, and agricultural sustainability. However, the effects on belowground processes is largely undocumented.

### Experimental design

Several resin bags were buried across an agricultural landscape to document the found effects of ABG vs. PBG on the soiul nitrate (NO3), ammonium (NH4), and phosphorus (P) depositon from May-August 2021. KCl was used to extrat the NO3 and NH4, HCl was used to extract P. The resin extracts were analyzed to determine the total composition of each variable within samples. 

-------------
-------------

# TASK 1
### Let's get this party started


In this first task, I am going to load in the tidyverse library and set up the theme. This allows me to play with the data and tidy it up, because researchers get messy with data collection!

```{r, library, message=FALSE, warning=FALSE}
library(tidyverse)
theme_set(theme_dark())
```

-------------
-------------

# Task 2
### Bring in the DATA! *triumphant fan fare*

I'm going to load in our data sets
```{r, read.csv}
PBG_N <- read.csv('PBG_N_compiled_raw_2021.csv')
PBG_P <- read.csv('PBG_P_compiled_raw_2021.csv')
PBG_trts <- read.csv('PBG_trts.csv')
```

-------------
-------------

# Task 3
### In a bind

For this task, we are going to combine the rows from both of our dataframes, and filter down to only keep the data in the "sample"
column which contains any data which begins with "U" using the grepl() function in dplyr.

```{r, rbind, filter}
PBG_Combine <-rbind(PBG_N,PBG_P)%>%
  filter(grepl("U", sample))
```


-------------
-------------

# Task 4 
### Out of the pan and into the R Markdown fire

Now things are going to get a little dicey. I need to join the data sets with our transect data. 
To do this, we first need to filter the maximum dilution of our Sample column. Then we will parse our
Sample column into four new columns, one of which we will no longer need (element)

```{r, group_by, filter}
PBG_Filter<- PBG_Combine %>% 
  group_by(Sample) %>% 
  filter(dilution == max(dilution, na.rm = TRUE)) %>% 
  separate(col = Sample, into = c('watershed', 'transect', 'plot', 'element'), sep = '-')%>%
  select(-element)%>%
  ungroup()

```
Then we will bring in the data from our transects by the new columns we created in our previous chunk.
We will also clean up and rename the tests used to make them more accessible to read.

```{r}
PBG_Merge <- merge(PBG_Filter,PBG_trts, by=c("watershed","transect","plot"),all.x=T)%>%
  mutate(test = ifelse(test=="HCl PO4_1",
    "Phosphate",ifelse(test=="KCL NO3_NO2 2", "Nitrate", "Ammonia")))
```



